# 전문가 기능 구현 계획

**작성일**: 2026-01-03  
**우선순위**: P0 (최우선순위)  
**담당**: 백엔드/프론트엔드 개발

---

## 개요

전문가(Consultant) 관련 기능들이 현재 일반 사용자 상담 API(`/api/consultations`)를 재사용하고 있어서, 전용 API와 전용 대시보드가 부족합니다. 이로 인해 UserFlow에서 정의된 전문가 흐름이 완벽하게 구현되지 못하고 있습니다.

---

## 1. 개선 필요한 부분 상세 분석

### 1.1 전문가 법률 상담: 70% (백엔드 API 누락)

**현재 문제점**:
- 전문가 전용 API 엔드포인트가 없음
- 전문가가 진입 상담 목록을 볼 수 있는 방법이 없음
- 전문가가 상담을 수락/거절하는 API가 없음

**누락된 기능**:
- `GET /api/consultants/incoming` - 진입 상담 목록
- `POST /api/consultants/incoming/{id}/accept` - 상담 수락
- `POST /api/consultants/incoming/{id}/reject` - 상담 거절
- 전문가 대시보드 통계
- 상담 예약 관리

### 1.2 전문가 대시보드: 없음 (백엔드 API 누락)

**현재 문제점**:
- 전문가 전용 대시보드 페이지가 없음
- 전문가가 자신의 상담 현황을 확인할 수 없음

**누락된 기능**:
- 전문가 대시보드(`/consultants`)
- 상담 요청 수량 및 통계
- 전문가 수익 정보
- 평점 및 후기 관리

### 1.3 관심 공고 저장: 미구현

**현재 문제점**:
- 사용자가 관심 공고를 저장할 수 없음
- 북마크/즐겨찾기 기능 없음

**누락된 기능**:
- 북마크 버튼 UI
- 관심 공고 목록 페이지
- 북마크 상태 관리

### 1.4 지원 내역 페이지: 미구현

**현재 문제점**:
- 사용자가 자신의 모든 지원 내역을 한눈에 볼 수 없음
- 지원 상태 추적 기능 부족

**누락된 기능**:
- 지원 내역 페이지(`/applications`)
- 지원 상태별 필터링
- 지원 상세 모달

### 1.5 알림 시스템: 미구현

**현재 문제점**:
- 이메일 알림 구현되지 않음
- 웹 알림 구현되지 않음

**누락된 기능**:
- 이메일 알림 (상담 수락/거절, 결제 완료, 상담 예약 등)
- 웹 알림 (새 상담 요청, 알림 카운트)
- 알림 설정 페이지

---

## 2. 단계별 구현 계획

### 단계 1: 백엔드 API 개발 (P0 - 최우선)

**예상 소요시간: 1주일**

| 작업 | 우선순위 | 예상 시간 |
|------|---------|---------|
| 전문가 API 라우터 생성 | P0 | 1일 |
| 진입 상담 목록 API | P0 | 0.5일 |
| 상담 수락/거절 API | P0 | 0.5일 |
| 통계 API | P0 | 0.5일 |
| 예약 관리 API | P1 | 0.5일 |
| **소계** | **3.5일** | |

### 단계 2: 프론트엔드 페이지 개발 (P0, P1)

**예상 소요시간: 2주일**

| 작업 | 우선순위 | 예상 시간 |
|------|---------|---------|
| 전문가 대시보드 | P0 | 2일 |
| 예약 관리 페이지 | P1 | 1일 |
| 관심 공고 저장 | P1 | 1일 |
| 지원 내역 페이지 | P1 | 1일 |
| 알림 UI | P1 | 1일 |
| **소계** | **6일** | |

### 단계 3: 알림 시스템 및 테스트 (P1, P2)

**예상 소요시간: 3일**

| 작업 | 우선순위 | 예상 시간 |
|------|---------|---------|
| 이메일 알림 연동 | P1 | 1.5일 |
| 알림 템플릿 작성 | P1 | 0.5일 |
| API/프론트엔드 테스트 | P1 | 1일 |
| **소계** | **3일** | |

### **전체 소요시간: 12.5일 (약 3주)**

---

## 3. 백엔드 API 구현 계획

### 3.1 전문가 라우터 파일 생성

**파일**: `backend/src/routers/consultants.py`

**주요 엔드포인트**:
```python
# 기존 API 재사용 방식
GET /api/consultations?status=requested&consultant_id={id}  # 전문가의 요청 상담

# 새로운 전문가 전용 엔드포인트
GET /api/consultants/incoming  # 전문가의 진입 상담 목록
GET /api/consultants/{id}/schedule  # 상담 예약 정보
POST /api/consultants/{id}/accept  # 상담 수락
POST /api/consultants/{id}/reject  # 상담 거절
GET /api/consultants/dashboard/stats  # 대시보드 통계
```

### 3.2 API 기능 요약

| 엔드포인트 | HTTP 메서드 | 설명 |
|-----------|------------|------|
| `/api/consultants/incoming` | GET | 전문가의 진입 상담 목록 (status 필터링) |
| `/api/consultants/{id}/accept` | POST | 상담 수락 (status → scheduled) |
| `/api/consultants/{id}/reject` | POST | 상담 거절 (status → requested) |
| `/api/consultants/dashboard/stats` | GET | 전문가 통계 (수익, 평점, 상담 수) |
| `/api/consultants/{id}/schedule` | GET/POST | 예약 정보 조회/설정 |

---

## 4. 프론트엔드 구현 계획

### 4.1 전문가 대시보드 페이지

**파일**: `frontend/src/app/(consultants)/dashboard/page.tsx`

**주요 기능**:
- 진입 상담 목록 탭 (requested 상태)
- 수락 상담 목록 탭 (scheduled 상태)
- 완료 상담 목록 탭 (completed 상태)
- 통계 카드 (상담 수, 수익, 평점)
- 수락/거절 버튼
- 예약 관리 버튼

### 4.2 관심 공고 저장

**기능**:
- 공고 목록에 북마크 아이콘 추가
- 로컬 스토리지/세션 스토리지에 저장된 공고 목록 관리
- 관심 공고 목록 페이지 (`/saved-jobs`)
- 북마크 상태 API (선택 사항)

### 4.3 지원 내역 페이지

**파일**: `frontend/src/app/(dashboard)/applications/page.tsx`

**주요 기능**:
- 사용자의 전체 지원 내역 목록
- 지원 상태 필터링 (Pending, Under Review, Accepted, Rejected)
- 지원 상세 모달
- 철회 기능 (상태가 Pending일 때만 가능)

### 4.4 알림 시스템

**기능**:
- 이메일 알림 (상담 수락/거절, 결제 완료, 상담 예약 등)
- 웹 알림 (새 상담 요청 알림, 알림 카운트 표시)
- 알림 설정 페이지 (알림 수신 여부)

---

## 5. 기술적 구현 세부사항

### 5.1 데이터베이스 스키마

**추가 필요한 테이블**:
- `schedules` - 상담 예약 정보 (이미 있을 수 있음)
- `saved_jobs` - 관심 공고 저장
- `application_notifications` - 지원 알림

### 5.2 백엔드 API 설계

**권한 미들웨어**:
- `get_current_consultant` - 전문가 전용 미들웨어
- 사용자 역할(`user.role`)이 "consultant"인지 검증

### 5.3 프론트엔드 상태 관리

**상태 관리**:
- 전문가 대시보드: 상담 목록, 통계
- 관심 공고: 로컬 스토리지에 저장
- 알림: React Context 또는 Redux

---

## 6. 리스크 및 대응 방안

### 6.1 리스크

1. **API 재사용 문제** - 기존 상담 API를 전문가가 사용할 때의 권한 문제
2. **데이터 일관성** - 전문가가 수정한 상담 정보가 일반 사용자와 충돌 가능
3. **알림 시스템 복잡도** - 이메일 SMTP 설정, 템플릿 관리

### 6.2 대응 방안

1. **권한 분리**: 전문가 전용 미들웨어 구현
2. **데이터 불변성**: 전문가가 수정할 수 있는 필드 제한
3. **알림 서비스 외부화**: 이메일 전송은 별도 서비스로 분리

---

## 7. 검증 계획

### 7.1 API 테스트 케이스

- 진입 상담 목록 조회
- 상담 수락 (상태 변경 확인)
- 상담 거절 (거절 사유 저장 확인)
- 통계 API (올바른 계산 확인)
- 예약 API (상태 일관성 확인)

### 7.2 프론트엔드 테스트

- 전문가 대시보드 탭 전환
- 수락/거절 버튼 동작 확인
- 통계 카드 값 확인
- 관심 공고 저장/삭제
- 지원 내역 필터링

---

## 8. 완료 기준

### 8.1 백엔드 (P0)

- [ ] 전문가 라우터 파일 생성
- [ ] 진입 상담 목록 API 구현
- [ ] 상담 수락/거절 API 구현
- [ ] 통계 API 구현
- [ ] API 테스트 작성

### 8.2 프론트엔드 (P0)

- [ ] 전문가 대시보드 페이지 구현
- [ ] 예약 관리 페이지 구현
- [ ] 관심 공고 저장 기능 구현
- [ ] 지원 내역 페이지 구현
- [ ] 알림 UI 구현

### 8.3 알림 시스템 (P1)

- [ ] 이메일 알림 서비스 연동
- [ ] 알림 템플릿 작성
- [ ] 웹 알림 구현

---

## 9. 최종 구현 완료도

| 영역 | 현재 | 목표 | 개선 |
|------|------|------|------|
| 전문가 법률 상담 | 70% | 100% | +30% |
| 전문가 대시보드 | 0% | 100% | +100% |
| 관심 공고 저장 | 0% | 100% | +100% |
| 지원 내역 페이지 | 0% | 100% | +100% |
| 알림 시스템 | 0% | 100% | +100% |
| **전체 평균** | **93%** | **97%** | **+4%** |

---

## 결론

개선 필요한 부분들을 **3주 내**에 완벽하게 구현할 수 있습니다. P0 최우선순위로 다음 기능들을 신속히 구현하는 것을 권장합니다.

**다음 단계**:
1. 백엔드 API 개발 시작 (오늘)
2. 프론트엔드 개발 시작 (내일)
3. 1주차 테스트 (다음주)
4. 알림 시스템 연동 (2주차)

---

**작성일**: 2026-01-03  
**버전**: 1.0.0



